<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Hibernate | 详解 | 漂泊者的理想三旬</title><meta name="keywords" content="Hibernate"><meta name="author" content="Feng Deng"><meta name="copyright" content="Feng Deng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Hibernate 日志记录日志: 程序开发中的一些信息 常用信息输出：System.out.println(&quot; &quot;); 这种方式不好，原因如下： 如果输出的内容比较多，项目已经开发完毕，不想使用输出，需要输出每个类，将输出的代码注释。 日志：Hibernate中使用slf4j技术 slf4j：SLF4J，即简单门面（Simple Logging Facade for Java">
<meta property="og:type" content="article">
<meta property="og:title" content="Hibernate | 详解">
<meta property="og:url" content="http://atideas.github.io/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="漂泊者的理想三旬">
<meta property="og:description" content="Hibernate 日志记录日志: 程序开发中的一些信息 常用信息输出：System.out.println(&quot; &quot;); 这种方式不好，原因如下： 如果输出的内容比较多，项目已经开发完毕，不想使用输出，需要输出每个类，将输出的代码注释。 日志：Hibernate中使用slf4j技术 slf4j：SLF4J，即简单门面（Simple Logging Facade for Java">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.dmoe.cc/random.php">
<meta property="article:published_time" content="2021-08-23T08:58:41.000Z">
<meta property="article:modified_time" content="2022-03-10T01:46:30.103Z">
<meta property="article:author" content="Feng Deng">
<meta property="article:tag" content="Hibernate">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.dmoe.cc/random.php"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/atideas/assets/static/favicon.ico"><link rel="canonical" href="http://atideas.github.io/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-36LL6FC11S"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-36LL6FC11S');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hibernate | 详解',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-10 09:46:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/all.css"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="漂泊者的理想三旬" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/atideas/assets/static/avatar.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/atideas/assets/static/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">174</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.dmoe.cc/random.php')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">漂泊者的理想三旬</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Hibernate | 详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-23T08:58:41.000Z" title="发表于 2021-08-23 16:58:41">2021-08-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-10T01:46:30.103Z" title="更新于 2022-03-10 09:46:30">2022-03-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>52分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Hibernate | 详解"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Hibernate-日志记录"><a href="#Hibernate-日志记录" class="headerlink" title="Hibernate 日志记录"></a>Hibernate 日志记录</h1><p>日志: 程序开发中的一些信息</p>
<p>常用信息输出：<code>System.out.println(&quot; &quot;);</code></p>
<p>这种方式不好，原因如下：</p>
<p>如果输出的内容比较多，项目已经开发完毕，不想使用输出，需要输出每个类，将输出的代码注释。</p>
<p>日志：<code>Hibernate</code>中使用<code>slf4j</code>技术</p>
<p><code>slf4j</code>：<code>SLF4J</code>，即简单门面（<code>Simple Logging Facade for Java</code>），不是具体的日志解决方案，它只服务于各种各样的日志系统。用于整合其他日志系统（在企业中常用的日志记录：<code>log4J</code>），是具体的日志记录方案</p>
<h1 id="Log4J-技术"><a href="#Log4J-技术" class="headerlink" title="Log4J 技术"></a>Log4J 技术</h1><ul>
<li>开发中的日志操作</li>
<li>开发阶段的调试信息</li>
<li>运行时的日志记录（日志代码占代码总量的 $4 %$）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (someCondition) &#123;</span><br><span class="line">   System.out.println(<span class="string">&quot;some information.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hibernate-中使用-Log4J-的步骤"><a href="#Hibernate-中使用-Log4J-的步骤" class="headerlink" title="Hibernate 中使用 Log4J 的步骤"></a>Hibernate 中使用 Log4J 的步骤</h1><ol>
<li><p>导入<code>Log4J</code>的<code>jar</code>包<br><code>apache-log4j-1.2.16</code>（在<code>Hibernate</code>中使用时还需要导入<code>slf4J</code>的<code>jar</code>包）。<br>在<code>Hibernate</code>中使用时需要单独下载<code>SLF4J</code>的<code>jar</code>包。</p>
 <div align="center">

<pre><code> ![](https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640142480-b85b6581.png)
</code></pre>
 </div></li>
<li><p>编写<code>Property</code>文件（<code>log4J</code>的配置信息）<br>参考模板在如下位置：<code>Hibernate_HOME/project/etc</code>，示例中可以将<code>log4j.properties</code>文件拷贝出来进行修改放在项目中的<code>classPath</code>即<code>src</code>下。</p>
 <div align="center">

<pre><code> ![](https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640142560-cfb6b8d3.png)
</code></pre>
 </div></li>
<li><p>在程序中获得<code>logger</code>对象<br>通过下列方法输出日志信息：</p>
<ul>
<li><code>public void debug(Object message);</code></li>
<li><code>public void info(Object message);</code></li>
<li><code>public void warn(Object message);</code></li>
<li><code>public void error(Object message);</code></li>
</ul>
<p>利用信息级别确保日志信息在内容上和反映问题的严重程度上，是非常重要的。</p>
<ul>
<li><code>fatal</code>：非常严重的错误，导致系统终止。期望这类信息能立即显示在状态控制台上</li>
<li><code>error</code>：即普通错误，其它运行期错误或不是预期条件。期望这类信息能立即显示在状态控制台上</li>
<li><code>warn</code>：警告，使用了不赞成使用的<code>API</code>、非常拙劣的使用<code>API</code>，几乎就是错误，其它运行时不合需要和不合预期的状态但还没必要称为错误。期望这类信息能立即显示在状态控制台上</li>
<li><code>info</code>：普通信息。运行时产生有意义的事件。期望这类事件能立即显示在状态控制台上</li>
<li><code>debug</code>：系统流程中的细节信息。期望这类信息仅被写入<code>log</code>文件中</li>
<li><code>trace</code>：堆栈信息。期望这类信息仅被写入<code>log</code>文件中</li>
</ul>
</li>
</ol>
<h1 id="配置文件（log4j-properties）"><a href="#配置文件（log4j-properties）" class="headerlink" title="配置文件（log4j.properties）"></a>配置文件（log4j.properties）</h1><p><code>Log4J</code>有三个主要部件：记录器（<code>Loggers</code>）、输出源（<code>Appenders</code>）、布局（<code>Layouts</code>）</p>
<p>组件简介：</p>
<ul>
<li>记录器（<code>loggers</code>）：用来配置日志输出级别，使用哪些输出源</li>
<li>格式：记录器=级别，输出源1，输出源2…，如<code>log4j.rootLogger=info,stdout</code>，<code>info</code>是日志级别，<code>stdout</code>是输出源名称</li>
<li><code>log4j</code>提供日志级别，由高到低：<code>fatal</code>（致命错误）、<code>error</code>（普通错误）、<code>warn</code>（警告）、<code>debug</code>（调试）、<code>trace</code>（堆栈）</li>
<li><code>log4j</code>记录日志时只会记录 配置级别以及更高级别的信息</li>
<li>输出源（<code>appenders</code>）：在<code>log4j</code>中可以定义多个输出源（控制台、日志文件、邮件、数据库）<code>log4j.appender</code>，输出源名称=实现类<ul>
<li><code>log4j.appender.stdout=org.apache.log4j.ConsoleAppender</code>：控制台进行输出</li>
<li><code>log4j.appender.file=org.apache.log4j.FileAppender</code>：向文件进行输出</li>
</ul>
</li>
<li>布局（<code>Layouts</code>）：在日志中都记录哪些信息<ul>
<li><code>log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</code>：自定义布局</li>
<li><code>log4j.appender.stdout.layout.ConversionPattern=%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</code>：自定义布局格式</li>
</ul>
</li>
</ul>
<p>示例如下：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=DEBUG, A1</span><br><span class="line">log4j.appender.A1=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.A1.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.A1.layout.ConversionPattern= %-4r [%t] %-5p %c %x - %m%n</span><br></pre></td></tr></table></figure>

<h2 id="配置时的注意事项"><a href="#配置时的注意事项" class="headerlink" title="配置时的注意事项"></a>配置时的注意事项</h2><ol>
<li><code>log4j.properties</code>被放置到<code>ClassPath</code>所指定的目录下</li>
<li><code>log4j</code>的日志记录的优先级分为<code>FATAL</code>、<code>ERROR</code>、<code>WARN</code>、<code>INFO</code>、<code>DEBUG</code>、<code>TRACE</code>或者您定义的级别。<code>Log4j</code>建议只使用四个级别，优先级从高到低分别是<code>ERROR</code>、<code>WARN</code>、<code>INFO</code>、<code>DEBUG</code>。通过在这里定义的级别，您可以控制到应用程序中相应级别的日志信息的开关。比如在这里定义了<code>INFO</code>级别，则应用程序中所有<code>DEBUG</code>级别的日志信息将不被打印出来</li>
</ol>
<h2 id="Log4J-提供的输出源"><a href="#Log4J-提供的输出源" class="headerlink" title="Log4J 提供的输出源"></a>Log4J 提供的输出源</h2><ul>
<li><code>org.apache.log4j.ConsoleAppender</code>（控制台）</li>
<li><code>org.apache.log4j.FileAppender</code>（文件）</li>
<li><code>org.apache.log4j.DailyRollingFileAppender</code>（每天产生一个日志文件）</li>
<li><code>org.apache.log4j.RollingFileAppender</code>（文件到达指定大小时产生一个新文件）</li>
<li><code>org.apache.log4j.WriterAppender</code>（将日志信息以流方式发送到任何地方）</li>
</ul>
<h2 id="Log4J-提供的-layout"><a href="#Log4J-提供的-layout" class="headerlink" title="Log4J 提供的 layout"></a>Log4J 提供的 layout</h2><ul>
<li><code>org.apache.log4j.HTMLLayout</code>（以<code>HTML</code>表格形式布局）</li>
<li><code>org.apache.log4j.PatternLayout</code>（可以灵活的自己指定布局模式）</li>
<li><code>org.apache.log4j.SimpleLayout</code>（包含日志信息的级别和信息字符串）</li>
<li><code>org.apache.log4j.TTCCLayout</code>（包含日志产生的时间、线程、类别等信息）</li>
</ul>
<h2 id="自定义布局的-layout-中的格式符"><a href="#自定义布局的-layout-中的格式符" class="headerlink" title="自定义布局的 layout 中的格式符"></a>自定义布局的 layout 中的格式符</h2><ul>
<li><code>%c</code>：列出<code>logger</code>名字空间的全称，如果加上{&lt;层数&gt;}表示列出从最内层算起的指定层数的名称空间。假设当前<code>logger</code>的名字空间是<code>a.b.c</code><ul>
<li><code>%c  —&gt; a.b.c</code></li>
<li><code>%c&#123;2&#125; —&gt;b.c</code></li>
<li><code>%c&#123;1&#125; —&gt;c</code></li>
</ul>
</li>
<li><code>%20c</code>（若名字空间长度小于 $20$，则左边用空格填充）</li>
<li><code>%-20c</code>（若名字空间小于 $20$，则右边用空格填充）</li>
<li><code>%.30c</code>（若名字空间长度超过 $30$，截取多余字符）</li>
<li><code>%20.30c</code>（若名字空间长度小于 $20$，则左边用空格填充；若名字空间长度超过 $30$，截取多余字符）</li>
<li><code>%-20.30c</code>（若名字空间长度小于 $20$，则右边用空格填充；若名字空间超过 $30$，截取多余字符）</li>
<li><code>%C</code>：列出调用<code>logger</code>的类的全名（包含包路径），假设当前类是<code>org.apache.xyz.SomeClass</code>，则：<ul>
<li><code>%C —&gt;org.apache.xyz.SomeClass</code></li>
<li><code>%C&#123;2&#125;—&gt;xyz.SomeClass</code></li>
</ul>
</li>
<li><code>%d</code>：显示日志记录时间，{&lt;日期格式&gt;}  使用<code>ISO8601</code>定义的日期格式<ul>
<li><code>%d&#123;yyyy/MM/dd HH:mm:ss,sss&#125; —&gt; 2005/10/12 22:23:30,117</code></li>
<li><code>%d&#123;ABSOLUTE&#125; —&gt; 22:23:30,117</code></li>
<li><code>%d&#123;DATE&#125; —&gt; 12 Oct 2005 22:23:30,117</code></li>
<li><code>%d&#123;ISO8601&#125; —&gt; 2005-10-12 22:23:30,117</code></li>
</ul>
</li>
<li><code>%F</code>：显示调用<code>logger</code>的源文件名<ul>
<li><code>%F —&gt; MyClass.java</code></li>
</ul>
</li>
<li><code>%l</code>：输出日志事件的发生位置，包括类目名、发生的线程，以及在代码中的行数<ul>
<li><code>%l —&gt; MyClass.main(MyClass.java:129)</code></li>
</ul>
</li>
<li><code>%L</code>：显示调用<code>logger</code>的代码行   <ul>
<li><code>%L—&gt; 129</code></li>
</ul>
</li>
<li><code>%m</code>：显示输出消息  <ul>
<li><code>%m —&gt; This is a message for debug</code></li>
</ul>
</li>
<li><code>%M</code>：显示调用<code>logger</code>的方法名  <ul>
<li><code>%M —&gt; main</code></li>
</ul>
</li>
<li><code>%n</code>：当前平台下的换行符<code>Windows</code>平台下表示<code>rn</code>，<code>UNIX</code>平台下表示<code>n</code></li>
<li><code>%p</code>：显示该条日志的优先级<ul>
<li><code>%p —&gt; INFO</code></li>
</ul>
</li>
<li><code>%r</code>：显示从程序启动到记录该条日志已经过去的毫秒数  <ul>
<li><code>%r —&gt; 1215</code></li>
</ul>
</li>
<li><code>%t</code>：输出产生该日志事件的线程名  <ul>
<li><code>%t —&gt; MyClass</code></li>
</ul>
</li>
<li><code>%x</code>：按<code>NDC</code>（<code>Nested Diagnostic Context</code>，线程堆栈）假设某程序调用顺序是<code>MyApp</code>调用<code>com.foo.Bar</code><ul>
<li><code>%c %x - %m%n   —&gt;   MyApp - Call com.foo.Bar.</code></li>
<li><code>com.foo.Bar - Log in Bar</code></li>
<li><code>MyApp - Return to MyApp.</code></li>
</ul>
</li>
<li><code>%X</code>：按<code>MDC</code>（<code>Mapped  Diagnostic  Context</code>，线程映射表）输出日志。通常用于多个客户端连接同一台服务器，方便服务器区分是哪个客户端访问留下的日志<ul>
<li><code>%X&#123;5&#125;  —&gt; (记录代号为 5 的客户端记录)</code></li>
</ul>
</li>
<li><code>%%</code>：显示一个百分号   <ul>
<li><code>%% —&gt; %</code></li>
</ul>
</li>
</ul>
<h1 id="在-Tomcat6-下配置-log4j-的步骤"><a href="#在-Tomcat6-下配置-log4j-的步骤" class="headerlink" title="在 Tomcat6 下配置 log4j 的步骤"></a>在 Tomcat6 下配置 log4j 的步骤</h1><ol>
<li>首先需要准备的文件为：<ul>
<li><a target="_blank" rel="noopener" href="http://www.apache.org/dist/logging/log4j/1.2.15/apache-log4j-1.2.15.zip"><code>log4j.jar</code>下载地址</a></li>
<li><code>log4j</code>配置文件<code>log4j.properties</code><br>   注意：日志级别不能太低，如果配置为<code>debug</code>的话，输出的日志信息太多，导致<code>tomcat</code>启动非常的慢。</li>
</ul>
</li>
<li>获得<code>logger</code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.javaresearch.log4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLog4J</span> &#123;   </span><br><span class="line">	<span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> Logger.getLogger(TestLog4J.class.getName());  </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;	    <span class="comment">// logging的各种方法	  </span></span><br><span class="line">		log.debug(<span class="string">&quot;Start of main()&quot;</span>);  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li></li>
</ol>
<h1 id="关于-Log4J-比较全面的配置"><a href="#关于-Log4J-比较全面的配置" class="headerlink" title="关于 Log4J 比较全面的配置"></a>关于 Log4J 比较全面的配置</h1><h2 id="应用于文件"><a href="#应用于文件" class="headerlink" title="应用于文件"></a>应用于文件</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.FILE</span>=<span class="string">org.apache.log4j.FileAppender </span></span><br><span class="line"><span class="attr">log4j.appender.FILE.File</span>=<span class="string">C:\file.log </span></span><br><span class="line"><span class="attr">log4j.appender.FILE.Append</span>=<span class="string">false </span></span><br><span class="line"><span class="attr">log4j.appender.FILE.layout</span>=<span class="string">org.apache.log4j.PatternLayout log4j.appender.FILE.layout.ConversionPattern= [framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n</span></span><br></pre></td></tr></table></figure>

<h2 id="应用于控制台"><a href="#应用于控制台" class="headerlink" title="应用于控制台"></a>应用于控制台</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.CONSOLE</span>=<span class="string">org.apache.log4j.ConsoleAppender </span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.Target</span>=<span class="string">System.out </span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.layout</span>=<span class="string">org.apache.log4j.PatternLayout log4j.appender.CONSOLE.layout.ConversionPattern=[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n</span></span><br></pre></td></tr></table></figure>

<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><ol>
<li><code>log4j.properties</code><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&lt;span</span> <span class="string">style=&quot;font-size:18px;&quot;&gt;### direct log messages to stdout ###</span></span><br><span class="line"><span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.Target</span>=<span class="string">System.err</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%d&#123;ABSOLUTE&#125; %5p %c&#123;2&#125;:%L - %m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### direct messages to file mylog.log</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log4j.appender.file</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="attr">log4j.appender.file.File</span>=<span class="string">d\:mylog.log</span></span><br><span class="line"><span class="attr">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### set log levels - for more verbose logging change &#x27;info&#x27; to &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">info, stdout ,file</span></span><br><span class="line"><span class="attr">&lt;/span&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><code>Log4JTest</code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.test.log4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 日志记录的类:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log4JTest</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> Logger.getLogger(Log4JTest.class);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo1</span><span class="params">()</span>&#123;</span><br><span class="line">		logger.fatal(<span class="string">&quot;致命错误&quot;</span>);</span><br><span class="line">		logger.error(<span class="string">&quot;普通错误&quot;</span>);</span><br><span class="line">		logger.warn(<span class="string">&quot;警告信息&quot;</span>);</span><br><span class="line">		logger.info(<span class="string">&quot;普通信息&quot;</span>);</span><br><span class="line">		logger.debug(<span class="string">&quot;调试信息&quot;</span>);</span><br><span class="line">		logger.trace(<span class="string">&quot;堆栈信息&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>输出到日志文件<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">设置消息级别为 info，info及其以上的级别都会打印</span></span><br><span class="line">20:09:12,094 FATAL log4j.Log4JTest:16 - 致命错误</span><br><span class="line">20:09:12,099 ERROR log4j.Log4JTest:17 - 普通错误</span><br><span class="line">20:09:12,100  WARN log4j.Log4JTest:18 - 警告信息</span><br><span class="line">20:09:12,101  INFO log4j.Log4JTest:19 - 普通信息</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Hibernate快速入门"><a href="#Hibernate快速入门" class="headerlink" title="Hibernate快速入门"></a>Hibernate快速入门</h1><h2 id="下载-Hibernate3-x-的开发包"><a href="#下载-Hibernate3-x-的开发包" class="headerlink" title="下载 Hibernate3.x 的开发包"></a>下载 Hibernate3.x 的开发包</h2><div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640149568-7c4ce606.png"></p>
</div>

<p><code>slf4j</code>与其他日志框架的关系</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640149591-576584ff.png"></p>
</div>

<h2 id="Hibernate-框架目录结构"><a href="#Hibernate-框架目录结构" class="headerlink" title="Hibernate 框架目录结构"></a>Hibernate 框架目录结构</h2><div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640149619-e264a56f.png"></p>
</div>

<h3 id="目录说明"><a href="#目录说明" class="headerlink" title="目录说明"></a>目录说明</h3><ul>
<li><code>documentation:Hibernate</code>文档</li>
<li><code>lib</code>：<code>Hibernate</code>开发的<code>jar</code>包</li>
<li><code>bytecode</code>：操作字节码的<code>jar</code>包</li>
<li><code>jpa</code>：<code>Hibernate</code>的实现<code>JPA</code>规范</li>
<li><code>optional</code>：<code>Hibernate</code>的可选<code>jar</code>包</li>
<li><code>required</code>：<code>Hibernate</code>必须导入的<code>jar</code>包</li>
<li><code>project</code>：<code>Hibernate</code>提供的工程</li>
</ul>
<h2 id="创建一个工程：（Java工程）"><a href="#创建一个工程：（Java工程）" class="headerlink" title="创建一个工程：（Java工程）"></a>创建一个工程：（Java工程）</h2><p>导入相应的<code>jar</code>包：</p>
<ul>
<li><code>hibernate3.jar</code></li>
<li><code>HIBERNATE_HOME / lib / required/*.jar</code></li>
<li><code>HIBERNATE_HOME/lib/jpa/hibernate-jpa-2.0-api-1.0.1.Final.jar</code></li>
<li>导入日志记录的包:</li>
<li><code>log4j-1.2.16.jar</code></li>
<li><code>slf4j-log4j12-1.7.2.jar</code></li>
<li>导入数据库驱动:</li>
</ul>
<h2 id="搭建环境（创建一个-customer-表与对应的持久化类）"><a href="#搭建环境（创建一个-customer-表与对应的持久化类）" class="headerlink" title="搭建环境（创建一个 customer 表与对应的持久化类）"></a>搭建环境（创建一个 customer 表与对应的持久化类）</h2><ul>
<li>数据表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> customer;</span><br></pre></td></tr></table></figure>
|Field|Type|Null|Key|Defaule|Extra|<br>|:—:|:—:|:—:|:—:|:—:|<br>|id|int(11)|NO|PRI|NULL|auto_increment|<br>|name|varchar(20)|YES||NULL||<br>|age|int(11)|YES||NULL||<br>|city|varchar(20)|YES||NULL||</li>
<li>实体类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	<span class="keyword">private</span> String city;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="在-Customer-class-所在的目录创建映射文件"><a href="#在-Customer-class-所在的目录创建映射文件" class="headerlink" title="在 Customer.class 所在的目录创建映射文件"></a>在 Customer.class 所在的目录创建映射文件</h2><p><code>Customer.hbm.xml</code>（<code>类名.hbm.xml</code>）</p>
<p>配置规则参考<code>hibernate2.jar org/hibernate/hibernate-mappong-3.0.dtd</code></p>
<p>查找位置如下：</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640150069-0f272406.png"></p>
</div>

<p>配置<code>Customer.hbm.xml</code>内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">hibernate-mapping</span> <span class="keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置类 和数据表 对应关系 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;cn.itcast.domain.Customer&quot;</span> <span class="attr">table</span>=<span class="string">&quot;customer&quot;</span> <span class="attr">select-before-update</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 配置哪个属性 关联数据表主键 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- 主键生成策略 --&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;identity&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 普通属性 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 如果属性名和列名相同 可以省略 column --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 类型也可以使用默认生成规则，省略type --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="java、hibernate、sql类型对应关系"><a href="#java、hibernate、sql类型对应关系" class="headerlink" title="java、hibernate、sql类型对应关系"></a>java、hibernate、sql类型对应关系</h3><table>
<thead>
<tr>
<th align="center"><code>Customer</code>类属性</th>
<th align="center"><code>Java</code>类型</th>
<th align="center"><code>Hibernate</code>类型</th>
<th align="center"><code>Customers</code>字段名</th>
<th align="center"><code>SQL</code>类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>Name</code></td>
<td align="center"><code>java.lang.String</code></td>
<td align="center"><code>string</code></td>
<td align="center"><code>NAME</code></td>
<td align="center">`Varcgar(12)</td>
</tr>
<tr>
<td align="center"><code>age</code></td>
<td align="center"><code>int</code></td>
<td align="center"><code>int</code></td>
<td align="center"><code>age</code></td>
<td align="center"><code>INT</code></td>
</tr>
<tr>
<td align="center"><code>Sex</code></td>
<td align="center"><code>char</code></td>
<td align="center"><code>character</code></td>
<td align="center"><code>SEX</code></td>
<td align="center"><code>CHAR(1)</code></td>
</tr>
<tr>
<td align="center"><code>Married</code></td>
<td align="center"><code>boolean</code></td>
<td align="center"><code>boolean</code></td>
<td align="center"><code>married</code></td>
<td align="center"><code>bit</code></td>
</tr>
<tr>
<td align="center"><code>Des</code></td>
<td align="center">j<code>ava.lang.String</code></td>
<td align="center"><code>text</code></td>
<td align="center"><code>des</code></td>
<td align="center"><code>CLOB</code></td>
</tr>
<tr>
<td align="center"><code>Pic</code></td>
<td align="center"><code>byte[]</code></td>
<td align="center"><code>binary</code></td>
<td align="center"><code>pic</code></td>
<td align="center"><code>BLOB</code></td>
</tr>
<tr>
<td align="center"><code>Birthday</code></td>
<td align="center"><code>java.sql.DATE</code></td>
<td align="center"><code>date</code></td>
<td align="center"><code>BIRTHDAY</code></td>
<td align="center"><code>DATE</code></td>
</tr>
<tr>
<td align="center"><code>registeredTime</code></td>
<td align="center"><code>java.sql.TimeStamp</code></td>
<td align="center"><code>timestamp</code></td>
<td align="center"><code>REGISTERED_TIME</code></td>
<td align="center"><code>TIMESTAMP</code></td>
</tr>
</tbody></table>
<h2 id="配置-JDBC-连接数据库基本属性"><a href="#配置-JDBC-连接数据库基本属性" class="headerlink" title="配置 JDBC 连接数据库基本属性"></a>配置 JDBC 连接数据库基本属性</h2><p>在<code>src</code>下创建<code>hibernate.cfg.xml</code></p>
<p>规则参考<code>hibernate3.jar  /org/hibernate/hibernate-configuration-3.0.dtd</code>.</p>
<p><code>hibernate.cfg.xml</code>内容配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">hibernate-configuration</span> <span class="keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 会话连接工厂，建立数据库连接需要SessionFactory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- JDBC连接基本参数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.url&quot;</span>&gt;</span>jdbc:mysql:///hibernatetest<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.password&quot;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置数据库方言，便于生成一些与数据库相关SQL方言 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQL5Dialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 可以根据需要自动创建数据表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 将SQL语句 输出到控制台 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- JavaEE6 使用BeanValidator校验，需要设置校验模式--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 		&lt;property name=&quot;javax.persistence.validation.mode&quot;&gt;none&lt;/property&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;cn/itcast/domain/Customer.hbm.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="编程操作-hibernate-框架"><a href="#编程操作-hibernate-框架" class="headerlink" title="编程操作 hibernate 框架"></a>编程操作 hibernate 框架</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实例化配置对象，加载配置文件 hibernate.cfg.xml</span></span><br><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line"><span class="comment">// 创建会话连接工厂</span></span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="comment">// 创建会话 </span></span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="comment">// 开启事务</span></span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">...  这里可以编写hibernate操作代码逻辑</span><br><span class="line"><span class="comment">// 提交事务，释放资源</span></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<h2 id="Hibernate-的-CRUD-操作"><a href="#Hibernate-的-CRUD-操作" class="headerlink" title="Hibernate 的 CRUD 操作"></a>Hibernate 的 CRUD 操作</h2><h3 id="Hibernate-操作一（插入数据）"><a href="#Hibernate-操作一（插入数据）" class="headerlink" title="Hibernate 操作一（插入数据）"></a>Hibernate 操作一（插入数据）</h3><p>通过<code>Session</code>对象的<code>save</code>方法  <code>Serializable save(Object  object)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer.setName(<span class="string">&quot;小丽&quot;</span>);</span><br><span class="line"><span class="type">Serializable</span> <span class="variable">save</span> <span class="operator">=</span> session.save(customer);</span><br><span class="line">System.out.println(save);</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<h3 id="Hibernate操作二（修改数据）"><a href="#Hibernate操作二（修改数据）" class="headerlink" title="Hibernate操作二（修改数据）"></a>Hibernate操作二（修改数据）</h3><p>通过<code>Session</code>的<code>update</code>方法   <code>void  update(Object object)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer.setId(<span class="number">1</span>);</span><br><span class="line">customer.setName(<span class="string">&quot;小明&quot;</span>);</span><br><span class="line">customer.setAge(<span class="number">20</span>);</span><br><span class="line">customer.setCity(<span class="string">&quot;北京)&quot;</span>;</span><br><span class="line"></span><br><span class="line">session.update(customer);</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<h4 id="注意：修改有两种方式"><a href="#注意：修改有两种方式" class="headerlink" title="注意：修改有两种方式"></a>注意：修改有两种方式</h4><h5 id="方式一：手动创建对象的方式："><a href="#方式一：手动创建对象的方式：" class="headerlink" title="方式一：手动创建对象的方式："></a>方式一：手动创建对象的方式：</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer.setId(<span class="number">2</span>);</span><br><span class="line">customer.setName(<span class="string">&quot;苍老师&quot;</span>);</span><br><span class="line">session.update(customer);</span><br></pre></td></tr></table></figure>

<p>使用这种方式，如果手动创建的对象中 只对一部分属性赋值，那么剩余的属性将以默认值存入（不建议使用）</p>
<h5 id="方式二：先查询再进行修改的方式（推荐使用）"><a href="#方式二：先查询再进行修改的方式（推荐使用）" class="headerlink" title="方式二：先查询再进行修改的方式（推荐使用）"></a>方式二：先查询再进行修改的方式（推荐使用）</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.get(Customer.class, <span class="number">1</span>);</span><br><span class="line">customer.setName(<span class="string">&quot;凤姐&quot;</span>);</span><br><span class="line">session.update(customer);</span><br></pre></td></tr></table></figure>

<h3 id="Hibernate操作三（删除数据）"><a href="#Hibernate操作三（删除数据）" class="headerlink" title="Hibernate操作三（删除数据）"></a>Hibernate操作三（删除数据）</h3><p>通过<code>Session</code>的<code>delete</code>方法   <code>void  delete(Object  object)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer.setId(<span class="number">1</span>);</span><br><span class="line">session.delete(customer);</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<h4 id="注意—删除记录也有两种方式"><a href="#注意—删除记录也有两种方式" class="headerlink" title="注意—删除记录也有两种方式"></a>注意—删除记录也有两种方式</h4><h5 id="方式一：手动创建对象的方式"><a href="#方式一：手动创建对象的方式" class="headerlink" title="方式一：手动创建对象的方式"></a>方式一：手动创建对象的方式</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 手动创建对象的方式</span></span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer.setId(<span class="number">2</span>);</span><br><span class="line">session.delete(customer);</span><br></pre></td></tr></table></figure>

<h5 id="方式二：先查询再删除的方式"><a href="#方式二：先查询再删除的方式" class="headerlink" title="方式二：先查询再删除的方式"></a>方式二：先查询再删除的方式</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer)session.get(Customer.class, <span class="number">1</span>);</span><br><span class="line">session.delete(customer);</span><br></pre></td></tr></table></figure>

<p>两种方式的区别：当只涉及到一个表时，没有明显的区别，但当涉及到多个有关系的表时就有区别了 手动创建对象的删除方式是不能配置级联删除的，而先查询再删除的方式是可以配置级联删除的</p>
<h3 id="Hibernate-操作四（根据主键查询数据）"><a href="#Hibernate-操作四（根据主键查询数据）" class="headerlink" title="Hibernate 操作四（根据主键查询数据）"></a>Hibernate 操作四（根据主键查询数据）</h3><p>根据主键查询  通过<code>Session</code>的<code>get</code>或<code>load</code>方法  </p>
<ul>
<li><code>Object  get(Class clazz,  Serializable  id)</code></li>
<li><code>Object  load(Class clazz,  Serializable  id)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.get(Customer.class, <span class="number">1</span>);</span><br><span class="line">System.out.println(customer.getName());</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer)session.get(Customer.class ,<span class="number">1</span>);</span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer)session.load(Customer.class,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="get-和-load-的区别-重点-面试题"><a href="#get-和-load-的区别-重点-面试题" class="headerlink" title="get 和 load 的区别(重点+面试题)"></a>get 和 load 的区别(重点+面试题)</h4><h5 id="发送-SQL-的时机不同"><a href="#发送-SQL-的时机不同" class="headerlink" title="发送 SQL 的时机不同"></a>发送 SQL 的时机不同</h5><p><code>load</code>这个方法采用了一个技术叫<code>lazy</code>延迟加载（懒加载）只有真正使用这个对象的数据的时候才发送<code>SQL</code>（对象的数据不包括主键，也就是说只查询主键时是不会发送<code>SQL</code>的）</p>
<p><code>get</code>方法是立即检索，当执行<code>session.get()</code>方法的时候，马上发送<code>SQL</code>语句进行查询。</p>
<h5 id="返回的对象不同"><a href="#返回的对象不同" class="headerlink" title="返回的对象不同"></a>返回的对象不同</h5><p><code>load</code>方法返回的是代理对象。</p>
<p><code>get</code>方法返回的是真实的对象。</p>
<h5 id="查询一个不存在的数据时抛出的异常不同"><a href="#查询一个不存在的数据时抛出的异常不同" class="headerlink" title="查询一个不存在的数据时抛出的异常不同"></a>查询一个不存在的数据时抛出的异常不同</h5><p><code>load</code>方法抛出异常：<code>ObjectNotFoundException</code></p>
<p><code>get</code>方法抛出异常：<code>NullPointException</code></p>
<h3 id="Hibernate-操作五（查询所有数据）"><a href="#Hibernate-操作五（查询所有数据）" class="headerlink" title="Hibernate 操作五（查询所有数据）"></a>Hibernate 操作五（查询所有数据）</h3><h4 id="Hibernate-框架查询数据-可以通过-Query-对象完成"><a href="#Hibernate-框架查询数据-可以通过-Query-对象完成" class="headerlink" title="Hibernate 框架查询数据  可以通过 Query 对象完成"></a>Hibernate 框架查询数据  可以通过 Query 对象完成</h4><p><code>Session</code>对象提供了两个方法可以获得<code>Query</code>对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Query  <span class="title function_">createQuery</span><span class="params">(String   queryString)</span>  接受HQL</span><br><span class="line">SQLQuery  <span class="title function_">createSQLQuery</span><span class="params">(String queryString)</span>  接受SQL</span><br></pre></td></tr></table></figure>

<h4 id="HQL—Hibernate-Query-Language-描写对象操作的一种查询语言"><a href="#HQL—Hibernate-Query-Language-描写对象操作的一种查询语言" class="headerlink" title="HQL—Hibernate  Query Language  描写对象操作的一种查询语言"></a>HQL—Hibernate  Query Language  描写对象操作的一种查询语言</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Query query=session.createQuery(<span class="string">&quot;from Customer&quot;</span>);</span><br><span class="line">这里的Customer是类名</span><br></pre></td></tr></table></figure>

<h4 id="SQL—Structured-Query-Language-面向数据库查询语言"><a href="#SQL—Structured-Query-Language-面向数据库查询语言" class="headerlink" title="SQL—Structured Query Language  面向数据库查询语言"></a>SQL—Structured Query Language  面向数据库查询语言</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createSQLQuery(<span class="string">&quot;select * from customer&quot;</span>);  </span><br><span class="line">这里参数就是普通SQL语句 </span><br></pre></td></tr></table></figure>

<p><code>HQL</code>查询结果会自动封装为<code>Java</code>对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer&quot;</span>);</span><br><span class="line">List&lt;Customer&gt; customer = query.list();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Customer customer:customers)&#123;</span><br><span class="line">    System.out.println(customer.getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<p><code>SQLQuery</code>会将查询结果每条数据封装为一个<code>Object[]</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;select * from Customer&quot;</span>);</span><br><span class="line">List&lt;Object[]&gt; customer = query.list();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Object[] arr:customers)&#123;</span><br><span class="line">    System.out.println(Arrays.toString(arr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">transaction.commit();</span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<h4 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h4><h5 id="HQL"><a href="#HQL" class="headerlink" title="HQL:"></a>HQL:</h5><p><code>HQL:Hibernate Query Language.</code></p>
<p>面向对象的写法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer where name = ?&quot;</span>);</span><br><span class="line">query.setParameter(<span class="number">0</span>, <span class="string">&quot;苍老师&quot;</span>);</span><br><span class="line">query.list();</span><br></pre></td></tr></table></figure>

<h5 id="QBC"><a href="#QBC" class="headerlink" title="QBC:"></a>QBC:</h5><p><code>Query By Criteria.</code>（条件查询）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> session.createCriteria(Customer.class);</span><br><span class="line">criteria.add(Restrictions.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;凤姐&quot;</span>));</span><br><span class="line">List&lt;Customer&gt; list = criteria.list();</span><br></pre></td></tr></table></figure>

<h5 id="SQL"><a href="#SQL" class="headerlink" title="SQL:"></a>SQL:</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SQLQuery</span> <span class="variable">query</span> <span class="operator">=</span> session.createSQLQuery(<span class="string">&quot;select * from customer&quot;</span>);</span><br><span class="line">List&lt;Object[]&gt; list = query.list();</span><br><span class="line"><span class="type">SQLQuery</span> <span class="variable">query</span> <span class="operator">=</span> session.createSQLQuery(<span class="string">&quot;select * from customer&quot;</span>);</span><br><span class="line">query.addEntity(Customer.class);</span><br><span class="line">List&lt;Customer&gt; list = query.list();</span><br></pre></td></tr></table></figure>

<p><code>Hibernate</code>运行的流程图如下：</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640151588-b3a5593f.png"></p>
</div>

<h1 id="Hibernate-常见配置及核心-API"><a href="#Hibernate-常见配置及核心-API" class="headerlink" title="Hibernate 常见配置及核心 API"></a>Hibernate 常见配置及核心 API</h1><h2 id="Hibernate-体系结构及常见配置"><a href="#Hibernate-体系结构及常见配置" class="headerlink" title="Hibernate 体系结构及常见配置"></a>Hibernate 体系结构及常见配置</h2><div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640151612-a1b134bb.png"></p>
</div>

<p><code>Hibernate</code>的持久化方案，将用户从原始的<code>JDBC</code>底层<code>SQL</code>访问中解放出来。</p>
<p>用户无须关注底层数据库的操作，只要通过操作映射到数据表的<code>Java</code>对象，就可以对数据库进行增删改查。</p>
<p><code>Hibernate</code>框架支持两种H<code>ibernate</code>属性配置方式：<code>hibernate.properties</code>和<code>hibernate.cfg.xml</code>。</p>
<p>采用<code>properties</code>方式必须手动编程加载<code>hbm</code>文件或者持久化类<br>采用<code>xml</code>配置方式，可以配置添加<code>hbm文</code>件</p>
<p>核心配置的两种方式进行配置:</p>
<h3 id="属性文件的配置"><a href="#属性文件的配置" class="headerlink" title="属性文件的配置:"></a>属性文件的配置:</h3><p><code>hibernate.properties</code></p>
<p>格式: <code>key=value</code></p>
<p><code>hibernate.connection.driver_class=com.mysql.jdbc.Driver</code></p>
<p>注意:没有办法在核心配置文件中加载映射文件.(必须手动编码的方式进行加载.)</p>
<h3 id="XML-格式文件配置"><a href="#XML-格式文件配置" class="headerlink" title="XML 格式文件配置:"></a>XML 格式文件配置:</h3><p><code>hibernate.cfg.xml</code></p>
<p>格式:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>Hibernate</code>核心配置常用属性</p>
<p>在<code>project/etc/hibernate.properties</code>中配置了<code>hibernate</code>常用的一些属性信息</p>
<h4 id="核心配置："><a href="#核心配置：" class="headerlink" title="核心配置："></a>核心配置：</h4><h5 id="必须的配置"><a href="#必须的配置" class="headerlink" title="必须的配置"></a>必须的配置</h5><p>连接数据库的 $4$ 个基本参数：</p>
<ul>
<li><code>hibernate.connection.driver_class</code>  连接数据库驱动程序</li>
<li><code>hibernate.connection.url</code>   连接数据库的URL</li>
<li><code>hibernate.connection.username</code>   数据库用户名</li>
<li><code>hibernate.connection.password</code>    数据库密码</li>
</ul>
<p><code>hibernate</code>的方言</p>
<ul>
<li><code>hibernate.dialect</code>   操作数据的方言</li>
</ul>
<h5 id="可选的配置"><a href="#可选的配置" class="headerlink" title="可选的配置"></a>可选的配置</h5><ul>
<li>hibernate.show_sql   true   在控制台上输出SQL语句</li>
<li>hibernate.format_sql   true  格式化控制台输出的SQL语句</li>
<li>hibernate.connection.autocommit   true   事务是否自动提交</li>
<li>hibernate.hbm2ddl.auto  create/create-drop/update/validate</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create  ：每次执行的时候，创建一个新的表（如果以前有该表，将该表删除重新创建）一般测试的时候使用.</span><br><span class="line">          create-drop：每次执行的时候，创建一个新的表，程序执行结束后将这个表删除掉了。一般测试的时候使用。</span><br><span class="line">          update：如果数据库中没有表，创建一个新的表，如果有了，直接使用这个表。可以更新表的结构.</span><br><span class="line">          validate：会使用原有的表，完成校验，校验映射文件与表中配置的字段是否一致，不一致报错</span><br></pre></td></tr></table></figure>

<h5 id="映射的配置"><a href="#映射的配置" class="headerlink" title="映射的配置"></a>映射的配置</h5><p>在核心配置文件中加载映射文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;cn/itcast/hibernate3/demo1/Customer.hbm.xml&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用手动编码的方式进行加载hbm.xml映射文件  </p>
<p>configuration.addResource(“cn/itcast/hibernate3/demo1/Customer.hbm.xml”);或 configuration.addClass(Customer.class);  </p>
<p>注意：在核心配置文件中加载映射文件时有一个小技巧</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640151779-cb72170b.png"></p>
</div>

<h4 id="映射文件的配置"><a href="#映射文件的配置" class="headerlink" title="映射文件的配置"></a>映射文件的配置</h4><p>ORM：对象关系映射。需要在映射文件（命名格式：持久化类名.hbm.xml）中配置Java对象与表的映射。</p>
<h5 id="配置类与表的映射："><a href="#配置类与表的映射：" class="headerlink" title="配置类与表的映射："></a>配置类与表的映射：</h5><p>　　name：类的全路径</p>
<p>　　table：表的名称（可以省略，若不写表名则使用类的名称作为表名）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;cn.itcast.hibernate3.demo1.Order&quot;</span> <span class="attr">table</span>=<span class="string">&quot;orders&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="配置普通属性与字段映射："><a href="#配置普通属性与字段映射：" class="headerlink" title="配置普通属性与字段映射："></a>配置普通属性与字段映射：</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>  <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>  <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>  <span class="attr">length</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　type：三种写法<br>Java类型：java.lang.String<br>Hibernate类型：string<br>SQL类型：不能直接使用type属性，需要子标签<column></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">column</span>  <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">sql-type</span>=<span class="string">&quot;varchar(20)&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="配置唯一标识与主键映射："><a href="#配置唯一标识与主键映射：" class="headerlink" title="配置唯一标识与主键映射："></a>配置唯一标识与主键映射：</h5><h6 id="一个表中只有一个主键的形式"><a href="#一个表中只有一个主键的形式" class="headerlink" title="一个表中只有一个主键的形式"></a>一个表中只有一个主键的形式</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>  <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;assigned&quot;</span>/&gt;</span>  <span class="comment">&lt;!-- 生成策略 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="一个表对应多个主键形式：-复合主键"><a href="#一个表对应多个主键形式：-复合主键" class="headerlink" title="一个表对应多个主键形式：(复合主键)"></a>一个表对应多个主键形式：(复合主键)</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">composite-id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">key-property</span> <span class="attr">name</span>=<span class="string">&quot;firstname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;firstname&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">key-property</span> <span class="attr">name</span>=<span class="string">&quot;lastname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;lastname&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;string&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">composite-id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="关联关系"><a href="#关联关系" class="headerlink" title="关联关系"></a>关联关系</h5><h5 id="命名SQL"><a href="#命名SQL" class="headerlink" title="命名SQL"></a>命名SQL</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">query</span>  <span class="attr">name</span>=<span class="string">&quot;findAll&quot;</span>&gt;</span>  from Customer  <span class="tag">&lt;/<span class="name">query</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">sql-query</span>  <span class="attr">name</span>=<span class="string">&quot;sqlFindAll&quot;</span> &gt;</span>  select * from customer <span class="tag">&lt;/<span class="name">sql-query</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Hibernate的核心API"><a href="#Hibernate的核心API" class="headerlink" title="Hibernate的核心API"></a>Hibernate的核心API</h2><p>Hibernate体系结构</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640151812-1e1d958b.png"></p>
</div>

<h3 id="Hibernate-API简介-—-Configuration类"><a href="#Hibernate-API简介-—-Configuration类" class="headerlink" title="Hibernate  API简介 — Configuration类"></a>Hibernate  API简介 — Configuration类</h3><p>　　Configuration类负责管理Hibernate的配置信息。包括如下内容：<br>加载hibernate.properties 和hibernate.cfg.xml<br>持久化类与数据表的映射关系( *.hbm.xml)</p>
<h4 id="加载核心配置文件"><a href="#加载核心配置文件" class="headerlink" title="加载核心配置文件"></a>加载核心配置文件</h4><p>　　创建Configuration的两种方式：</p>
<h5 id="方式一：加载属性文件（hibernate-properties）"><a href="#方式一：加载属性文件（hibernate-properties）" class="headerlink" title="方式一：加载属性文件（hibernate.properties）"></a>方式一：加载属性文件（hibernate.properties）</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span>  <span class="variable">cfg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();  <span class="comment">// 手动加载hbm</span></span><br></pre></td></tr></table></figure>

<h5 id="方式二：加载xml文件（hibernate-cfg-xml）"><a href="#方式二：加载xml文件（hibernate-cfg-xml）" class="headerlink" title="方式二：加载xml文件（hibernate.cfg.xml）"></a>方式二：加载xml文件（hibernate.cfg.xml）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Configuration configuration = new Configuration().configure();</span><br></pre></td></tr></table></figure>

<h4 id="手动加载映射文件"><a href="#手动加载映射文件" class="headerlink" title="手动加载映射文件"></a>手动加载映射文件</h4><h5 id="第一种写法："><a href="#第一种写法：" class="headerlink" title="第一种写法："></a>第一种写法：</h5><p>通过Configuration对象的addResource方法添加hbm文件映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  加载位于cn.itcast.domain包下面Customer.hbm.xml文件</span></span><br><span class="line">configuration.addResource(<span class="string">&quot;cn/itcast/domain/Customer.hbm.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="第二种写法："><a href="#第二种写法：" class="headerlink" title="第二种写法："></a>第二种写法：</h5><p>　　通过addClass添加持久化类，Hibernate会在类所在包自动搜索hbm映射文件<br>要求：映射文件名称要规范，类与映射文件在同一个包下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configuration.addClass(Customer.class);</span><br></pre></td></tr></table></figure>

<h3 id="Hibernate-API简介—SessionFactory接口"><a href="#Hibernate-API简介—SessionFactory接口" class="headerlink" title="Hibernate API简介—SessionFactory接口"></a>Hibernate API简介—SessionFactory接口</h3><p>　　Configuration对象根据当前的配置信息生成SessionFactory对象<br>SessionFactory对象中保存了当前的数据库配置信息和所有映射关系以及预定义的SQL语句<br>SessionFactory 对象是线程安全的<br>SessionFactory还负责维护Hibernate的二级缓存</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configuration configuration=<span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br></pre></td></tr></table></figure>

<p>　　SessionFactory对象根据数据库信息，维护连接池，创建Session(相当于Connection)对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Session</span>  <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br></pre></td></tr></table></figure>

<p>　　构造SessionFactory很消耗资源，一般情况下一个应用只初始化一个<br>抽取HibernateUtils类用来提供Session对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateUtils</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Configuration configuratin;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> SessionFactory sessionFactory;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span>&#123;</span><br><span class="line"></span><br><span class="line">		configuration = <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">		sessionFactory = configuration.buildSessionFactory();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="title function_">SessionopenSession</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sessionFactory.openSession();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用C3P0连接池"><a href="#使用C3P0连接池" class="headerlink" title="使用C3P0连接池"></a>使用C3P0连接池</h4><p>引入c3p0-0.9.1.jar</p>
<p>在hibernate.cfg.xml文件中增加如下配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- C3P0连接池设定--&gt;</span><br><span class="line">&lt;!-- 使用c3po连接池  配置连接池提供的供应商--&gt;</span><br><span class="line">&lt;property name=<span class="string">&quot;connection.provider_class&quot;</span>&gt;org.hibernate.connection.C3P0ConnectionProvider &lt;/property&gt;</span><br><span class="line">&lt;!--在连接池中可用的数据库连接的最少数目 --&gt;</span><br><span class="line">&lt;property name=<span class="string">&quot;c3p0.min_size&quot;</span>&gt;<span class="number">5</span>&lt;/property&gt;</span><br><span class="line">&lt;!--在连接池中所有数据库连接的最大数目  --&gt;</span><br><span class="line">&lt;property name=<span class="string">&quot;c3p0.max_size&quot;</span>&gt;<span class="number">20</span>&lt;/property&gt;</span><br><span class="line">&lt;!--设定数据库连接的过期时间,以秒为单位,</span><br><span class="line">如果连接池中的某个数据库连接处于空闲状态的时间超过了timeout时间,就会从连接池中清除 --&gt;</span><br><span class="line">&lt;property name=<span class="string">&quot;c3p0.timeout&quot;</span>&gt;<span class="number">120</span>&lt;/property&gt;</span><br><span class="line"> &lt;!--每<span class="number">3000</span>秒检查所有连接池中的空闲连接 以秒为单位--&gt;</span><br><span class="line">&lt;property name=<span class="string">&quot;c3p0.idle_test_period&quot;</span>&gt;<span class="number">3000</span>&lt;/property&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Hibernate-API简介—Session接口"><a href="#Hibernate-API简介—Session接口" class="headerlink" title="Hibernate API简介—Session接口"></a>Hibernate API简介—Session接口</h3><p>　　相当于JDBC的Connection<br>Session是应用程序与数据库之间交互操作的一个单线程对象，是Hibernate运作的中心<br>Session是线程不安全的<br>所有持久化对象必须在session的管理下才可以进行持久化操作<br>Session对象有一个一级缓存，显式执行flush之前，所有持久化操作的数据都缓存在session对象处<br>持久化类与Session关联起来后就具有了持久化的能力<br>Session维护了Hibernate的一级缓存</p>
<h4 id="常用方法如下："><a href="#常用方法如下：" class="headerlink" title="常用方法如下："></a>常用方法如下：</h4><ul>
<li>save() / persist()   ：添加。</li>
<li>update                  ：修改。</li>
<li>saveOrUpdate      ：增加和修改对象。</li>
<li>delete                    ：删除对象。</li>
<li>get() / load()          ：根据主键查询。</li>
<li>createQuery()       ：创建一个Query接口，编写HQL语句。</li>
<li>createSQLQuery()：创建一个SQLQuery接口，编写SQL语句  数据库操作对象。</li>
<li>createCriteria()     ：返回一个Criteria接口，条件查询。</li>
</ul>
<h3 id="Hibernate-API简介—Transaction接口"><a href="#Hibernate-API简介—Transaction接口" class="headerlink" title="Hibernate API简介—Transaction接口"></a>Hibernate API简介—Transaction接口</h3><p>　　代表数据库操作的事务对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> session.beginTransaction();</span><br></pre></td></tr></table></figure>

<p>　　提供事务管理的方法：</p>
<ul>
<li>commit()：提交相关联的session实例。</li>
<li>rollback()：撤销事务操作。</li>
<li>wasCommitted()：检查事务是否提交。</li>
</ul>
<p>　　如果没有开启事务，那么每个session的操作，都相当于一个独立的事务。注意：默认情况下这些独立的事务是不会提交的，都会进行回滚。</p>
<p>　　思考题：关羽和张飞的信息能否插入数据库</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configutre();</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"></span><br><span class="line"><span class="type">Customeer</span> <span class="variable">customer1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer1.setName(<span class="string">&quot;关羽&quot;</span>);</span><br><span class="line">session.save(customer1);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">Customeer</span> <span class="variable">customer2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">customer2.setName(<span class="string">&quot;张飞&quot;</span>);</span><br><span class="line">session.save(customer2);</span><br><span class="line"></span><br><span class="line">session.close();</span><br><span class="line">sessionFactory.close();</span><br></pre></td></tr></table></figure>

<p>　　如果在Hibernate的核心配置文件中配置了事务自动提交，则会将关羽的信息插入数据库，张飞的信息不会被插入数据库。如果在核心配置文件中没有配置事务自动提交，则张飞和关羽的信息都不会被插入数据库。</p>
<h3 id="Hibernate-API简介—-Query接口"><a href="#Hibernate-API简介—-Query接口" class="headerlink" title="Hibernate API简介— Query接口"></a>Hibernate API简介— Query接口</h3><p>　　Query代表面向对象的一个Hibernate查询操作。<br>session.createQuery  接受一个HQL语句。<br>HQL是Hibernate  Query  Language缩写，语法很像SQL语法，但它是完全面向对象的。</p>
<h4 id="使用Query对象的步骤："><a href="#使用Query对象的步骤：" class="headerlink" title="使用Query对象的步骤："></a>使用Query对象的步骤：</h4><ol>
<li>获得Hibernate  Session对象。</li>
<li>编写HQL语句。</li>
<li>调用session.createQuery 创建查询对象。</li>
<li>如果HQL语句包含参数，则调用Query的setXXX设置参数。</li>
<li>调用Query对象的list() 或uniqueResult() 方法执行查询。</li>
</ol>
<p>　　Query还包含两个方法，用于控制返回结果。</p>
<ul>
<li>setFirstResult(int  firstResult)：设置返回结果从第几条开始</li>
<li>setMaxResults(int maxResults)：设置本次返回结果的记录条数</li>
</ul>
<p>　　HQL入门举例：<br>以from开始HQL语句，调用list方法返回 List<Customer></p>
<ul>
<li>from Customer 查询customer表所有数据</li>
</ul>
<p>　　使用select 关键字 （查询部分对象属性）</p>
<ul>
<li>select name from Customer  返回List<String></li>
<li>select name,age from Customer 返回 List&lt;Object[] &gt;</li>
<li>select c.name from Customer as c 为Customer实例起别名</li>
</ul>
<p>　　使用where添加条件</p>
<ul>
<li>from Customer as c where c.age &gt; :age 其中:age是参数<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer as c where c.age &gt; :age&quot;</span>).setParameter(<span class="string">&quot;age&quot;</span>, <span class="number">15</span>);</span><br></pre></td></tr></table></figure></li>
<li>from Customer as c where c.age &gt; ? 其中?是参数<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer as c where c.age &gt; ?&quot;</span>).setParameter(<span class="number">0</span>, <span class="number">15</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Hibernate-API简介—Criteria接口"><a href="#Hibernate-API简介—Criteria接口" class="headerlink" title="Hibernate API简介—Criteria接口"></a>Hibernate API简介—Criteria接口</h3><p>　　Criteria是Hibernate提供的用于条件查询接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> session.createCriteria(Customer.class);</span><br></pre></td></tr></table></figure>

<p>　　使用Criteria对象的步骤：</p>
<ol>
<li>获得Hibernate的Session对象</li>
<li>通过Session获得Criteria对象</li>
<li>通过Restrictions的静态方法创建Criterion条件对象</li>
<li>向Criteria对象中添加Criterion查询条件</li>
<li>执行Criteria的list() 或 uniqueResult() 获得结果</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> session.createCriteria(Customer.class);</span><br><span class="line">criteria.add(Restrictions.gt(<span class="string">&quot;age&quot;</span>, <span class="number">15</span>));</span><br><span class="line"><span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) criteria.uniqueResult(); </span><br></pre></td></tr></table></figure>

<h1 id="Hibernate-持久化配置和操作"><a href="#Hibernate-持久化配置和操作" class="headerlink" title="Hibernate 持久化配置和操作"></a>Hibernate 持久化配置和操作</h1><h2 id="Hibernate-中的持久化类"><a href="#Hibernate-中的持久化类" class="headerlink" title="Hibernate 中的持久化类"></a>Hibernate 中的持久化类</h2><p>　　Hibernate采用普通、传统的Java对象（POJO），作为持久化类，与数据表进行映射。<br>编写规则：</p>
<ul>
<li>提供一个无参数public访问控制符的构造器（无参构造函数，因为Hibernate要使用反射进行操作）</li>
<li>提供一个标识属性，映射数据表主键字段。（Java区分两个对象是否是同一个使用地址，数据库区分两条记录是否一致使用主键，Hibernate中区分持久化对象是否是同一个则根据唯一标识）</li>
<li>所有属性提供public访问控制符的set / get方法。（框架存取值的时候使用）</li>
<li>标识属性应尽量使用基本数据类型的包装类型。</li>
<li>不要使用final修饰（将无法生成代理对象进行优化）</li>
</ul>
<p>　　注意：用final修饰的类是不能被继承的，无法生成代理对象（延迟加载的时候返回代理对象，延迟加载就会失效）</p>
<h2 id="持久化对象的唯一标识OID"><a href="#持久化对象的唯一标识OID" class="headerlink" title="持久化对象的唯一标识OID"></a>持久化对象的唯一标识OID</h2><ul>
<li>Java按地址区分同一个类的不同对象。</li>
<li>关系数据库用主键区分同一条记录。</li>
<li>Hibernate使用OID来建立内存中的对象和数据库中记录的对应关系。</li>
<li>对象的OID和数据库的表的主键对应。为保证OID的唯一性，应该让Hibernate来为OID进行赋值。</li>
</ul>
<h2 id="区分自然主键与代理主键"><a href="#区分自然主键与代理主键" class="headerlink" title="区分自然主键与代理主键"></a>区分自然主键与代理主键</h2><p>在关系数据库中，用主键来识别记录并保证每条记录的唯一性，作为主键的字段必须满足以下条件：</p>
<ul>
<li>不允许为<code>null</code></li>
<li>每条记录具有惟一的主键值，不允许主键值重复</li>
<li>每条记录的主键值永远不会改变</li>
</ul>
<p>在<code>CUSTOMERS</code>表中，如果把<code>NAME</code>字段作为主键，前提条件是：</p>
<ul>
<li>每条记录的客户姓名不允许为<code>null</code></li>
<li>不允许客户重名</li>
<li>不允许修改客户姓名</li>
</ul>
<p><code>NAME</code>字段是具有业务含义的字段，把这种字段作为主键，称为自然主键。尽管也是可行的，但是不能满足不断变化的业务需求，一旦出现了允许客户重名的业务需求，就必须修改数据模型，重新定义表的主键，这给数据库的维护增加了难度。</p>
<p>因此，更合理的方式是使用代理主键，即不具备业务含义的字段，该字段一般取名为<code>ID</code>。代理主键通常为整数级别，因为整数类型比字符串类型要节省更多的数据库空间，那么代理主键的值从何而来呢？许多数据库系统都提供了自动生成代理主键的机制。</p>
<h2 id="持久化类属性用基本类型还是包装类型？"><a href="#持久化类属性用基本类型还是包装类型？" class="headerlink" title="持久化类属性用基本类型还是包装类型？"></a>持久化类属性用基本类型还是包装类型？</h2><p>基本数据类型和包装类型对应<code>hibernate</code>的映射类型相同。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;property  name=<span class="string">&quot;price&quot;</span> type=<span class="string">&quot;double&quot;</span>  column=<span class="string">&quot;PRICE&quot;</span>  /&gt;</span><br></pre></td></tr></table></figure>

<p>　　基本类型可直接运算、无法表达null、数字类型的默认值是0.<br>包装类型默认值是null。当对于默认值有业务意义的时候需要使用包装类。<br>例如:Student类有一个int类型的scope属性,表示学生的考试分数.int类型的scope属性无法表达这样的业务需求:</p>
<ul>
<li>如果scope的属性为null,表示该学生的成绩是未知的,有可能得了100分，也有可能得了0分,只是暂时还不知道成绩</li>
<li>如果scope属性为0,表示学生考试成绩为0分.</li>
<li>在上面的情况中必须使用包装类型</li>
</ul>
<h2 id="详解对象—关系映射-hbm-文件"><a href="#详解对象—关系映射-hbm-文件" class="headerlink" title="详解对象—关系映射 hbm 文件"></a>详解对象—关系映射 hbm 文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置类和数据表的对应关系 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;cn.itcast.domain.Customer&quot;</span> <span class="attr">table</span>=<span class="string">&quot;customer&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">		&lt;!-- 配置哪个属性关联数据表主键 --&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">		&lt;id name=&quot;</span><span class="attr">id</span>&quot; <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 主键生成策略 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 普通属性 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 如果属性名和列名相同，可以省略 column --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 类型也可以使用默认生成规则，省略 type --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ID-和-generator-属性说明"><a href="#ID-和-generator-属性说明" class="headerlink" title="ID 和 generator 属性说明"></a>ID 和 generator 属性说明</h2><p>　　id：设定持久化类的OID和表的主键的映射。id标签有以下属性：</p>
<ul>
<li>name：表示持久化类OID的属性名。</li>
<li>column：设置标识属性所映射的数据列的列名（主键字段的名称）。</li>
<li>unsaved-value：若设定了该属性，Hibernate会通过比较持久化类的OID和该属性值来区分当前持久化类的对象是否是临时对象，Hibernate3中几乎不再需要。</li>
<li>type:指定 Hibernate 映射类型. Hibernate 映射类型是 Java 类型与 SQL 类型的桥梁. 如果没有为某个属性显式设定映射类型, Hibernate 会运用反射机制先识别出持久化类的特定属性的 Java 类型, 然后自动使用与之对应的默认的 Hibernate 映射类型</li>
<li>Java 的基本数据类型和包装类型对应相同的 Hibernate 映射类型. 基本数据类型无法表达 null, 所以对于持久化类的 OID 推荐使用包装类型（integer，long，string等）</li>
</ul>
<p>　　generator：设置持久化类指定标识符生成器。</p>
<ul>
<li>class：指定使用标识符生成器全限定 类名或其缩写名。</li>
</ul>
<h2 id="主键生成策略"><a href="#主键生成策略" class="headerlink" title="主键生成策略"></a>主键生成策略</h2><p>　　常用的几种标识符生成器以及相关描述如下：</p>
<ul>
<li>increment ：适用于代理主键。由Hibernate自动以递增的方式生成标识符，每次增量为1.</li>
<li>identity     ：适合代理主键。由底层数据库生成标识符。条件是数据库支持自动增长数据类型。</li>
<li>sequence ：适用于代理主键。Hibernate根据底层数据库序列生成标识符。条件是数据库支持序列。</li>
<li>native       ：适用于代理主键。根据底层数据库对自动生成标识符的能力来选择identity、sequence、hilo。</li>
<li>uuid          ：适用于代理主键。Hibernate采用128位的UUID算法来生成标识符。该算法能够在网络环境中生成唯一的字符串标识符，这种策略并不流行，因为字符串类型的主键比整数类型的主键占用更多的数据库空间。</li>
<li>assigned  ：适用于自然主键。由Java程序员负责生成标识符。不能把setId()声明为private类型。尽量避免使用自然主键。</li>
</ul>
<h3 id="主键生成策略increment"><a href="#主键生成策略increment" class="headerlink" title="主键生成策略increment"></a>主键生成策略increment</h3><p>　　increment标识符生成器<br>increment 标识符生成器由Hibernate以递增的方式为代理主键赋值。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;increment&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　Hibernate会先读取NEWS表中的主键的最大值，而接下来向NEWS表中插入记录时，就在max(id)的基础之上递增，增量为1（带走+1）<br>适用范围：</p>
<ul>
<li>由于increment生存标识符机制不依赖于底层数据库系统，因此它是适用于所有的数据库系统。</li>
<li>适用于只有单个Hibernate应用进程访问同一个数据库的场合。因为会产生多线程问题，在集群下不要使用。</li>
<li>OID必须为long，int，或short类型，如果把OID定义为byte类型，在运行时就会抛出异常。</li>
</ul>
<h3 id="主键生成策略-identity"><a href="#主键生成策略-identity" class="headerlink" title="主键生成策略 identity"></a>主键生成策略 identity</h3><p>　　identity标识符生成器由底层数据库负责生成标识符，它要求底层数据库把主键定义为自动增长字段类型（加1带走）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;identity&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　适用范围：</p>
<ul>
<li>由于identity生成标识符的机制依赖于底层数据库系统，因此要求底层数据库系统必须支持自动增长字段类型。支持自动增长字段类型的数据库包括：DB2，MySQL，MSSQLServer，Sybase等。</li>
<li>OID必须为long，int或short类型，如果把OID定义为byte类型，在运行时也会抛出异常。</li>
</ul>
<h3 id="主键生成策略-sequence"><a href="#主键生成策略-sequence" class="headerlink" title="主键生成策略 sequence"></a>主键生成策略 sequence</h3><p>　　sequence标识符生成器利用底层数据库提供的序列来生成标识符。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;sequence&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- news_seq：oracle 数据库中序列的名称 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">parm</span> <span class="attr">name</span>=<span class="string">&quot;sequence&quot;</span>&gt;</span>news_seq<span class="tag">&lt;/<span class="name">parm</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">generator</span>&gt;</span>&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　Hibernate在持久化一个NEWS对象时，先从底层数据库的news_seq序列中获得一个唯一的标识号，再把它作为主键值。<br>适用范围：</p>
<ul>
<li>由于sequence生成标识符的机制依赖于底层数据库系统的序列，因此，要求底层数据库系统必须支持序列。支持序列的数据库包括DB2、Oracle等。</li>
<li>OID必须为long、int、或short类型，如果把OID定义为byte类型，在运行时也会抛出异常。</li>
</ul>
<h3 id="主键生成策略-native"><a href="#主键生成策略-native" class="headerlink" title="主键生成策略 native"></a>主键生成策略 native</h3><p>　　native标识符生成器依赖底层数据库对自动生成标识符的支持能力，来选择identity，sequence或hilo标识符生成器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;integer&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　适用范围：</p>
<ul>
<li>由于native能根据底层数据库系统的类型，自动选择合适的标识符生成器，因此很适合用于跨数据库平台开发。</li>
<li>OID必须为long、int、或short类型，如果把OID定义为byte类型，在运行时也会抛出异常。</li>
</ul>
<h3 id="主键生成策略-uuid"><a href="#主键生成策略-uuid" class="headerlink" title="主键生成策略 uuid"></a>主键生成策略 uuid</h3><p>　　uuid 32位标识符生成器</p>
<div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640222020-4a52d240.png"></p>
</div>

<p>　　Hibernate会产生不重复的32位字符作为主键。</p>
<h3 id="主键生成策略-assigned"><a href="#主键生成策略-assigned" class="headerlink" title="主键生成策略 assigned"></a>主键生成策略 assigned</h3><p>　　assigned标识符生成器— 用于映射单个自然主键。<br>假如CUSTOMER表没有定义ID代理主键，而是以NAME字段作为主键，那么相应的，在Customer类中不必定义id属性，Customer类的OID为name属性，它的映射代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">cloumn</span>=<span class="string">&quot;name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;assigned&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="映射复合主键"><a href="#映射复合主键" class="headerlink" title="映射复合主键"></a>映射复合主键</h3><div align="center">

<p><img src="https://cdn.jsdelivr.net/gh/atideas/assets/1629709121/1640222285-243b9f6c.png"></p>
</div>

<h1 id="实例：-1"><a href="#实例：-1" class="headerlink" title="实例："></a>实例：</h1><p>　　Customer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.hibernate3.demo1;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- 实体类对象</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> Integer id;</span><br><span class="line">  <span class="comment">//private String id;</span></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">  	<span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">  	<span class="built_in">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">  	<span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">  	<span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">  	<span class="keyword">return</span> age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">  	<span class="built_in">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">  	<span class="keyword">return</span> <span class="string">&quot;Customer [id=&quot;</span> + id + <span class="string">&quot;, name=&quot;</span> + name + <span class="string">&quot;, age=&quot;</span> + age + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　HibernateTest1</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.hibernate3.demo1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Criteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SQLQuery;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- Hibernate入门案例的测试:</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateTest1</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 查询所有记录:SQL</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo7</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.操作</span></span><br><span class="line">  <span class="comment">// 查询所有:SQL</span></span><br><span class="line">  <span class="comment">/*SQLQuery query = session.createSQLQuery(&quot;select * from customer&quot;);</span></span><br><span class="line"><span class="comment">  List&lt;Object[]&gt; list = query.list();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  for (Object[] objs : list) &#123;</span></span><br><span class="line"><span class="comment">  	System.out.println(Arrays.toString(objs));</span></span><br><span class="line"><span class="comment">  &#125;*/</span></span><br><span class="line">  <span class="type">SQLQuery</span> <span class="variable">query</span> <span class="operator">=</span> session.createSQLQuery(<span class="string">&quot;select * from customer&quot;</span>);</span><br><span class="line">  query.addEntity(Customer.class);</span><br><span class="line">  List&lt;Customer&gt; list = query.list();</span><br><span class="line">  <span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">  	System.out.println(customer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 查询所有:QBC</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo6</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.操作:</span></span><br><span class="line">  <span class="comment">// 查询所有 :QBC.</span></span><br><span class="line">  <span class="comment">/*Criteria criteria = session.createCriteria(Customer.class);</span></span><br><span class="line"><span class="comment">  List&lt;Customer&gt; list = criteria.list();*/</span></span><br><span class="line">  <span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> session.createCriteria(Customer.class);</span><br><span class="line">  criteria.add(Restrictions.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;凤姐&quot;</span>));</span><br><span class="line">  List&lt;Customer&gt; list = criteria.list();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">  	System.out.println(customer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 查询所有:HQL.</span></span><br><span class="line">  <span class="comment">// HQL:Hibernate Query Language.Hibernate查询语言.面向对象的查询.</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo5</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 手动编码加载映射文件:</span></span><br><span class="line">  	<span class="comment">// configuration.addResource(&quot;cn/itcast/hibernate3/demo1/Customer.hbm.xml&quot;);</span></span><br><span class="line">  	<span class="comment">// configuration.addClass(Customer.class);</span></span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.操作</span></span><br><span class="line">  <span class="comment">// 1.查询所有的客户</span></span><br><span class="line">  <span class="comment">/*Query query = session.createQuery(&quot;from Customer&quot;);</span></span><br><span class="line"><span class="comment">  List&lt;Customer&gt; list = query.list();*/</span></span><br><span class="line">  <span class="comment">// 2.按名称查询</span></span><br><span class="line">  <span class="comment">/*Query query = session.createQuery(&quot;from Customer where name = ?&quot;);</span></span><br><span class="line"><span class="comment">  query.setParameter(0, &quot;苍老师&quot;);*/</span></span><br><span class="line">  <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer where name = :aaa&quot;</span>);</span><br><span class="line">  query.setParameter(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;苍老师&quot;</span>);</span><br><span class="line">  List&lt;Customer&gt; list = query.list();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">  	System.out.println(customer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 删除记录</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo4</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.操作</span></span><br><span class="line">  <span class="comment">// 删除记录有两种方式:</span></span><br><span class="line">  <span class="comment">// 5.1手动创建对象的方式</span></span><br><span class="line">  <span class="comment">/*Customer customer = new Customer();</span></span><br><span class="line"><span class="comment">  customer.setId(2);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  session.delete(customer);*/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.2先查询在删除的方式</span></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer)session.get(Customer.class, <span class="number">1</span>);</span><br><span class="line">  session.delete(customer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 修改记录</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo3</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.操作:</span></span><br><span class="line">  <span class="comment">// 修改记录:两种方式可以进行修改.</span></span><br><span class="line">  <span class="comment">// 5.1手动创建对象的方式</span></span><br><span class="line">  <span class="comment">/*Customer customer = new Customer();</span></span><br><span class="line"><span class="comment">  customer.setId(2);</span></span><br><span class="line"><span class="comment">  customer.setName(&quot;苍老师&quot;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  session.update(customer);*/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.2先查询在修改的方式</span></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.get(Customer.class, <span class="number">1</span>);</span><br><span class="line">  customer.setName(<span class="string">&quot;凤姐&quot;</span>);</span><br><span class="line"></span><br><span class="line">  session.update(customer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 按id进行查询</span></span><br><span class="line">  <span class="comment">// (*****面试题)get和load方法区别</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo2</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.加载核心配置文件</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.构建Session工厂</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.通过工厂创建Session</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  	<span class="comment">// 5.操作</span></span><br><span class="line">  	<span class="comment">// 根据id进行查询:</span></span><br><span class="line">  	<span class="comment">// get方法进行查询</span></span><br><span class="line">  	<span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.get(Customer.class, <span class="number">100</span>); <span class="comment">// 马上发生一条SQL进行查询</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  System.out.println(customer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load方法进行查询</span></span><br><span class="line">  <span class="comment">//Customer customer = (Customer) session.load(Customer.class, 100); // 没有发送SQL</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//System.out.println(customer);// 发送SQL.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 保存记录</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo1</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 1.Hiberante框架加载核心配置文件(有数据库连接信息)</span></span><br><span class="line">  	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	<span class="comment">// 2.创建一个SessionFactory.(获得Session--相当连接对象)</span></span><br><span class="line">  	<span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> configuration.buildSessionFactory();</span><br><span class="line">  	<span class="comment">// 3.获得Session对象.</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line">  	<span class="comment">// 4.默认的情况下,事务是不自动提交.</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  	<span class="comment">// 5.业务逻辑操作</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 向数据库中插入一条记录:</span></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;苍老师&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">38</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 6.事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line">  <span class="comment">// 7.释放资源</span></span><br><span class="line">  session.close();</span><br><span class="line">  sessionFactory.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>　　Customer.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入约束 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">hibernate-mapping</span> <span class="keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 建立类与表的映射 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- class标签:用于映射类与表的关系 name :类的全路径  table:表名称 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;cn.itcast.hibernate3.demo1.Customer&quot;</span> <span class="attr">table</span>=<span class="string">&quot;customer&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立类中属性与表中的字段映射 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 唯一标识 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 使用id的标签 配置唯一属性 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 在&lt;id&gt;标签中配置一个主键的生成策略. --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;assigned&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- 普通属性 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- property标签:映射类中的普通属性 name:类中的属性名称, column:表中字段名称 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			type:三种写法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		    - Java类型		:java.lang.String</span></span><br><span class="line"><span class="comment">  		    - Hibernate类型	:string</span></span><br><span class="line"><span class="comment">    	    - SQL类型		:不能直接使用type属性,需要子标签&lt;column&gt;</span></span><br><span class="line"><span class="comment">             - &lt;column name=&quot;name&quot; sql-type=&quot;varchar(20)&quot;/&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span> <span class="attr">length</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　hibernate.cfg.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">hibernate-configuration</span> <span class="keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">	<span class="string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">	<span class="string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 必须去配置的属性 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置数据库连接的基本信息: --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span>&gt;</span></span><br><span class="line">		com.mysql.jdbc.Driver</span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.url&quot;</span>&gt;</span></span><br><span class="line">		jdbc:mysql:///hibernate3_day01</span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.password&quot;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- Hibernate的方言 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 生成底层SQL不同的 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span></span><br><span class="line">		org.hibernate.dialect.MySQLDialect</span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 可选的属性 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 显示SQL --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 格式化SQL --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.autocommit&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- hbm:映射 to DDL: create drop alter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- C3P0连接池设定--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用c3po连接池  配置连接池提供的供应商--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.provider_class&quot;</span>&gt;</span>org.hibernate.connection.C3P0ConnectionProvider                                                                                                                                                     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在连接池中可用的数据库连接的最少数目 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c3p0.min_size&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--在连接池中所有数据库连接的最大数目  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c3p0.max_size&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设定数据库连接的过期时间,以秒为单位,</span></span><br><span class="line"><span class="comment">如果连接池中的某个数据库连接处于空闲状态的时间超过了timeout时间,就会从连接池中清除 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c3p0.timeout&quot;</span>&gt;</span>120<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--每3000秒检查所有连接池中的空闲连接 以秒为单位--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c3p0.idle_test_period&quot;</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 通知Hibernate加载那些映射文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;cn/itcast/hibernate3/demo1/Customer.hbm.xml&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　log4j.properties</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-size:18px;&quot;</span>&gt;</span>### direct log messages to stdout ###</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.Target=System.err</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d&#123;ABSOLUTE&#125; %5p %c&#123;2&#125;:%L - %m%n</span><br><span class="line"></span><br><span class="line">### direct messages to file mylog.log</span><br><span class="line"></span><br><span class="line">log4j.appender.file=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.file.File=d\:mylog.log</span><br><span class="line">log4j.appender.file.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.file.layout.ConversionPattern=%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</span><br><span class="line"></span><br><span class="line">### set log levels - for more verbose logging change &#x27;info&#x27; to &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">log4j.rootLogger=info, stdout ,file</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>　　HibernateUtils</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- Hibernate抽取工具类</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- *</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateUtils</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> SessionFactory sessionFactory;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span>&#123;</span><br><span class="line">  	configuration = <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">  	sessionFactory = configuration.buildSessionFactory();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Session <span class="title function_">openSession</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="keyword">return</span> sessionFactory.openSession();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">  	openSession();</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>　　HibernateTest2</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.hibernate3.demo1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Criteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.utils.HibernateUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- 抽取了Hibernate的工具类的使用</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateTest2</span> &#123;</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 保存数据</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo1</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;芙蓉&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 保存或更新()</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo2</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="comment">// 获得SEssion</span></span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="comment">// 开启事务</span></span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">/*Customer customer = new Customer();</span></span><br><span class="line"><span class="comment">  customer.setName(&quot;冠希&quot;);</span></span><br><span class="line"><span class="comment">  customer.setAge(34);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  session.saveOrUpdate(customer);*/</span></span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;冠希&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">34</span>);</span><br><span class="line"></span><br><span class="line">  session.saveOrUpdate(customer);</span><br><span class="line"></span><br><span class="line">  System.out.println(tx.wasCommitted());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事务提交</span></span><br><span class="line">  tx.commit();</span><br><span class="line"></span><br><span class="line">  System.out.println(tx.wasCommitted());</span><br><span class="line">  <span class="comment">// session关闭</span></span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 保存数据</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo3</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;芙蓉&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">Serializable</span> <span class="variable">id</span> <span class="operator">=</span> session.save(customer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// session.get(Customer.class, id);</span></span><br><span class="line"></span><br><span class="line">  session.update(customer);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 测试程序</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo4</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;关羽&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer);</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer2.setName(<span class="string">&quot;张飞&quot;</span>);</span><br><span class="line">  customer2.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer2);</span><br><span class="line"></span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// HQL:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo5</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  	<span class="comment">// 1.简单查询</span></span><br><span class="line">  	<span class="comment">// List&lt;Customer&gt; list = session.createQuery(&quot;from Customer&quot;).list();</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.条件查询:</span></span><br><span class="line">  <span class="comment">// List&lt;Customer&gt; list = session.createQuery(&quot;from Customer where name = ?&quot;).setParameter(0, &quot;芙蓉&quot;).list();</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.分页查询:select * from customer limit a,b; a:从哪开始  b:每页显示记录数.</span></span><br><span class="line">  <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from Customer&quot;</span>);</span><br><span class="line">  query.setFirstResult(<span class="number">3</span>);</span><br><span class="line">  query.setMaxResults(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">  List&lt;Customer&gt; list = query.list();</span><br><span class="line">  <span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">  	System.out.println(customer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// QBC:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo6</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  	<span class="comment">// 1.简单查询</span></span><br><span class="line">  	<span class="comment">//List&lt;Customer&gt; list = session.createCriteria(Customer.class).list();</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.条件查询:</span></span><br><span class="line">  <span class="comment">/*Criteria criteria = session.createCriteria(Customer.class);</span></span><br><span class="line"><span class="comment">  criteria.add(Restrictions.eq(&quot;name&quot;,&quot;芙蓉&quot;));</span></span><br><span class="line"><span class="comment">  List&lt;Customer&gt; list = criteria.list();*/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.分页查询:</span></span><br><span class="line">  <span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> session.createCriteria(Customer.class);</span><br><span class="line">  criteria.setFirstResult(<span class="number">3</span>);</span><br><span class="line">  criteria.setMaxResults(<span class="number">3</span>);</span><br><span class="line">  List&lt;Customer&gt; list = criteria.list();</span><br><span class="line">  <span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">  	System.out.println(customer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 演示错误:(注意:)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo7</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.get(Customer.class, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setId(<span class="number">10</span>);</span><br><span class="line">  customer.setName(<span class="string">&quot;张飞&quot;</span>);</span><br><span class="line">  session.update(customer2);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings(&quot;unused&quot;)</span></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 演示持久化类为final情况</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo8</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> (Customer) session.load(Customer.class, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>　　HibernateTest3</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.hibernate3.demo1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.utils.HibernateUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- 主键生成策略</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HibernateTest3</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 演示increment的问题:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo1</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  customer.setName(<span class="string">&quot;芙蓉&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="comment">// 演示increment的问题:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demo2</span><span class="params">()</span>&#123;</span><br><span class="line">  	<span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> HibernateUtils.openSession();</span><br><span class="line">  	<span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">  <span class="comment">// customer.setId(100);</span></span><br><span class="line">  customer.setName(<span class="string">&quot;凤姐&quot;</span>);</span><br><span class="line">  customer.setAge(<span class="number">26</span>);</span><br><span class="line"></span><br><span class="line">  session.save(customer);</span><br><span class="line"></span><br><span class="line">  tx.commit();</span><br><span class="line">  session.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>　　Log4JTest</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package cn.itcast.log4j;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.Logger;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line">- 日志记录的类:</span><br><span class="line">  */</span><br><span class="line">  public class Log4JTest &#123;</span><br><span class="line"></span><br><span class="line">  private Logger logger = Logger.getLogger(Log4JTest.class);</span><br><span class="line"></span><br><span class="line">  @Test</span><br><span class="line">  public void demo1()&#123;</span><br><span class="line">  	logger.fatal(&quot;致命错误&quot;);</span><br><span class="line">  	logger.error(&quot;普通错误&quot;);</span><br><span class="line">  	logger.warn(&quot;警告信息&quot;);</span><br><span class="line">  	logger.info(&quot;普通信息&quot;);</span><br><span class="line">  	logger.debug(&quot;调试信息&quot;);</span><br><span class="line">  	logger.trace(&quot;堆栈信息&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Feng Deng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://atideas.github.io/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/">http://atideas.github.io/2021/08/23/Hibernate/02.%E8%AF%A6%E8%A7%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://atideas.github.io" target="_blank">漂泊者的理想三旬</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hibernate/">Hibernate</a></div><div class="post_share"><div class="social-share" data-image="https://www.dmoe.cc/random.php" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/atideas/assets/static/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/atideas/assets/static/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/atideas/assets/static/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/atideas/assets/static/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/08/23/Hibernate/01.%E7%AE%80%E4%BB%8B/"><img class="prev-cover" src="https://www.dmoe.cc/random.php" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hibernate | 简介</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/23/Mybatis/02.SqlMapConfig/"><img class="next-cover" src="https://img.paulzzh.com/touhou/random" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Mybatis | SqlMapConfig</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/08/23/Hibernate/01.%E7%AE%80%E4%BB%8B/" title="Hibernate | 简介"><img class="cover" src="https://www.dmoe.cc/random.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-23</div><div class="title">Hibernate | 简介</div></div></a></div><div><a href="/2021/08/23/Hibernate/03.%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" title="Hibernate | 基本使用"><img class="cover" src="https://img.paulzzh.com/touhou/random" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-23</div><div class="title">Hibernate | 基本使用</div></div></a></div><div><a href="/2021/08/23/Hibernate/04.QBC%E8%AF%AD%E5%8F%A5/" title="Hibernate | QBC语句"><img class="cover" src="https://img.paulzzh.com/touhou/random" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-23</div><div class="title">Hibernate | QBC语句</div></div></a></div><div><a href="/2021/08/23/Hibernate/05.HQL%E8%AF%AD%E5%8F%A5/" title="Hibernate | HQL语句"><img class="cover" src="https://img.paulzzh.com/touhou/random" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-23</div><div class="title">Hibernate | HQL语句</div></div></a></div><div><a href="/2021/08/24/Hibernate/06.%E5%AE%9E%E4%BE%8B/" title="Hibernate | 实例"><img class="cover" src="https://api.ixiaowai.cn/api/api.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-24</div><div class="title">Hibernate | 实例</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/atideas/assets/static/avatar.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Feng Deng</div><div class="author-info__description">一身转战三千里，一剑曾当百万师</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">174</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/atideas"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/atideas" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3153896464@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎访问我的博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hibernate-%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">Hibernate 日志记录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Log4J-%E6%8A%80%E6%9C%AF"><span class="toc-number">2.</span> <span class="toc-text">Log4J 技术</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hibernate-%E4%B8%AD%E4%BD%BF%E7%94%A8-Log4J-%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.</span> <span class="toc-text">Hibernate 中使用 Log4J 的步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%88log4j-properties%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">配置文件（log4j.properties）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%97%B6%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.1.</span> <span class="toc-text">配置时的注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4J-%E6%8F%90%E4%BE%9B%E7%9A%84%E8%BE%93%E5%87%BA%E6%BA%90"><span class="toc-number">4.2.</span> <span class="toc-text">Log4J 提供的输出源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4J-%E6%8F%90%E4%BE%9B%E7%9A%84-layout"><span class="toc-number">4.3.</span> <span class="toc-text">Log4J 提供的 layout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%83%E5%B1%80%E7%9A%84-layout-%E4%B8%AD%E7%9A%84%E6%A0%BC%E5%BC%8F%E7%AC%A6"><span class="toc-number">4.4.</span> <span class="toc-text">自定义布局的 layout 中的格式符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8-Tomcat6-%E4%B8%8B%E9%85%8D%E7%BD%AE-log4j-%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">5.</span> <span class="toc-text">在 Tomcat6 下配置 log4j 的步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E-Log4J-%E6%AF%94%E8%BE%83%E5%85%A8%E9%9D%A2%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text">关于 Log4J 比较全面的配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%BA%8E%E6%96%87%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">应用于文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%BA%8E%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-number">6.2.</span> <span class="toc-text">应用于控制台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">6.3.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hibernate%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">7.</span> <span class="toc-text">Hibernate快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD-Hibernate3-x-%E7%9A%84%E5%BC%80%E5%8F%91%E5%8C%85"><span class="toc-number">7.1.</span> <span class="toc-text">下载 Hibernate3.x 的开发包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hibernate-%E6%A1%86%E6%9E%B6%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">7.2.</span> <span class="toc-text">Hibernate 框架目录结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E"><span class="toc-number">7.2.1.</span> <span class="toc-text">目录说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B7%A5%E7%A8%8B%EF%BC%9A%EF%BC%88Java%E5%B7%A5%E7%A8%8B%EF%BC%89"><span class="toc-number">7.3.</span> <span class="toc-text">创建一个工程：（Java工程）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA-customer-%E8%A1%A8%E4%B8%8E%E5%AF%B9%E5%BA%94%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%EF%BC%89"><span class="toc-number">7.4.</span> <span class="toc-text">搭建环境（创建一个 customer 表与对应的持久化类）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8-Customer-class-%E6%89%80%E5%9C%A8%E7%9A%84%E7%9B%AE%E5%BD%95%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">7.5.</span> <span class="toc-text">在 Customer.class 所在的目录创建映射文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java%E3%80%81hibernate%E3%80%81sql%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="toc-number">7.5.1.</span> <span class="toc-text">java、hibernate、sql类型对应关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-JDBC-%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E5%B1%9E%E6%80%A7"><span class="toc-number">7.6.</span> <span class="toc-text">配置 JDBC 连接数据库基本属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E6%93%8D%E4%BD%9C-hibernate-%E6%A1%86%E6%9E%B6"><span class="toc-number">7.7.</span> <span class="toc-text">编程操作 hibernate 框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hibernate-%E7%9A%84-CRUD-%E6%93%8D%E4%BD%9C"><span class="toc-number">7.8.</span> <span class="toc-text">Hibernate 的 CRUD 操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-%E6%93%8D%E4%BD%9C%E4%B8%80%EF%BC%88%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">7.8.1.</span> <span class="toc-text">Hibernate 操作一（插入数据）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate%E6%93%8D%E4%BD%9C%E4%BA%8C%EF%BC%88%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">7.8.2.</span> <span class="toc-text">Hibernate操作二（修改数据）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%9A%E4%BF%AE%E6%94%B9%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">7.8.2.1.</span> <span class="toc-text">注意：修改有两种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%9A"><span class="toc-number">7.8.2.1.1.</span> <span class="toc-text">方式一：手动创建对象的方式：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E5%85%88%E6%9F%A5%E8%AF%A2%E5%86%8D%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%88%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%EF%BC%89"><span class="toc-number">7.8.2.1.2.</span> <span class="toc-text">方式二：先查询再进行修改的方式（推荐使用）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate%E6%93%8D%E4%BD%9C%E4%B8%89%EF%BC%88%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">7.8.3.</span> <span class="toc-text">Hibernate操作三（删除数据）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E2%80%94%E5%88%A0%E9%99%A4%E8%AE%B0%E5%BD%95%E4%B9%9F%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">7.8.3.1.</span> <span class="toc-text">注意—删除记录也有两种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">7.8.3.1.1.</span> <span class="toc-text">方式一：手动创建对象的方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E5%85%88%E6%9F%A5%E8%AF%A2%E5%86%8D%E5%88%A0%E9%99%A4%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">7.8.3.1.2.</span> <span class="toc-text">方式二：先查询再删除的方式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-%E6%93%8D%E4%BD%9C%E5%9B%9B%EF%BC%88%E6%A0%B9%E6%8D%AE%E4%B8%BB%E9%94%AE%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">7.8.4.</span> <span class="toc-text">Hibernate 操作四（根据主键查询数据）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#get-%E5%92%8C-load-%E7%9A%84%E5%8C%BA%E5%88%AB-%E9%87%8D%E7%82%B9-%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">7.8.4.1.</span> <span class="toc-text">get 和 load 的区别(重点+面试题)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%91%E9%80%81-SQL-%E7%9A%84%E6%97%B6%E6%9C%BA%E4%B8%8D%E5%90%8C"><span class="toc-number">7.8.4.1.1.</span> <span class="toc-text">发送 SQL 的时机不同</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AF%B9%E8%B1%A1%E4%B8%8D%E5%90%8C"><span class="toc-number">7.8.4.1.2.</span> <span class="toc-text">返回的对象不同</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E6%97%B6%E6%8A%9B%E5%87%BA%E7%9A%84%E5%BC%82%E5%B8%B8%E4%B8%8D%E5%90%8C"><span class="toc-number">7.8.4.1.3.</span> <span class="toc-text">查询一个不存在的数据时抛出的异常不同</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-%E6%93%8D%E4%BD%9C%E4%BA%94%EF%BC%88%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">7.8.5.</span> <span class="toc-text">Hibernate 操作五（查询所有数据）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hibernate-%E6%A1%86%E6%9E%B6%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE-%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87-Query-%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%88%90"><span class="toc-number">7.8.5.1.</span> <span class="toc-text">Hibernate 框架查询数据  可以通过 Query 对象完成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HQL%E2%80%94Hibernate-Query-Language-%E6%8F%8F%E5%86%99%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E7%A7%8D%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">7.8.5.2.</span> <span class="toc-text">HQL—Hibernate  Query Language  描写对象操作的一种查询语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E2%80%94Structured-Query-Language-%E9%9D%A2%E5%90%91%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">7.8.5.3.</span> <span class="toc-text">SQL—Structured Query Language  面向数据库查询语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A"><span class="toc-number">7.8.5.4.</span> <span class="toc-text">实例：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#HQL"><span class="toc-number">7.8.5.4.1.</span> <span class="toc-text">HQL:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#QBC"><span class="toc-number">7.8.5.4.2.</span> <span class="toc-text">QBC:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SQL"><span class="toc-number">7.8.5.4.3.</span> <span class="toc-text">SQL:</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hibernate-%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE%E5%8F%8A%E6%A0%B8%E5%BF%83-API"><span class="toc-number">8.</span> <span class="toc-text">Hibernate 常见配置及核心 API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hibernate-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%8F%8A%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.</span> <span class="toc-text">Hibernate 体系结构及常见配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.1.</span> <span class="toc-text">属性文件的配置:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XML-%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.2.</span> <span class="toc-text">XML 格式文件配置:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="toc-number">8.1.2.1.</span> <span class="toc-text">核心配置：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BF%85%E9%A1%BB%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.2.1.1.</span> <span class="toc-text">必须的配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.2.1.2.</span> <span class="toc-text">可选的配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.2.1.3.</span> <span class="toc-text">映射的配置</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.2.2.</span> <span class="toc-text">映射文件的配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%B8%8E%E8%A1%A8%E7%9A%84%E6%98%A0%E5%B0%84%EF%BC%9A"><span class="toc-number">8.1.2.2.1.</span> <span class="toc-text">配置类与表的映射：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%99%AE%E9%80%9A%E5%B1%9E%E6%80%A7%E4%B8%8E%E5%AD%97%E6%AE%B5%E6%98%A0%E5%B0%84%EF%BC%9A"><span class="toc-number">8.1.2.2.2.</span> <span class="toc-text">配置普通属性与字段映射：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86%E4%B8%8E%E4%B8%BB%E9%94%AE%E6%98%A0%E5%B0%84%EF%BC%9A"><span class="toc-number">8.1.2.2.3.</span> <span class="toc-text">配置唯一标识与主键映射：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E8%A1%A8%E4%B8%AD%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E4%B8%BB%E9%94%AE%E7%9A%84%E5%BD%A2%E5%BC%8F"><span class="toc-number">8.1.2.2.3.1.</span> <span class="toc-text">一个表中只有一个主键的形式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E8%A1%A8%E5%AF%B9%E5%BA%94%E5%A4%9A%E4%B8%AA%E4%B8%BB%E9%94%AE%E5%BD%A2%E5%BC%8F%EF%BC%9A-%E5%A4%8D%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-number">8.1.2.2.3.2.</span> <span class="toc-text">一个表对应多个主键形式：(复合主键)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB"><span class="toc-number">8.1.2.2.4.</span> <span class="toc-text">关联关系</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%91%BD%E5%90%8DSQL"><span class="toc-number">8.1.2.2.5.</span> <span class="toc-text">命名SQL</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hibernate%E7%9A%84%E6%A0%B8%E5%BF%83API"><span class="toc-number">8.2.</span> <span class="toc-text">Hibernate的核心API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B-%E2%80%94-Configuration%E7%B1%BB"><span class="toc-number">8.2.1.</span> <span class="toc-text">Hibernate  API简介 — Configuration类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.2.1.1.</span> <span class="toc-text">加载核心配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E5%8A%A0%E8%BD%BD%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6%EF%BC%88hibernate-properties%EF%BC%89"><span class="toc-number">8.2.1.1.1.</span> <span class="toc-text">方式一：加载属性文件（hibernate.properties）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E5%8A%A0%E8%BD%BDxml%E6%96%87%E4%BB%B6%EF%BC%88hibernate-cfg-xml%EF%BC%89"><span class="toc-number">8.2.1.1.2.</span> <span class="toc-text">方式二：加载xml文件（hibernate.cfg.xml）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">8.2.1.2.</span> <span class="toc-text">手动加载映射文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E5%86%99%E6%B3%95%EF%BC%9A"><span class="toc-number">8.2.1.2.1.</span> <span class="toc-text">第一种写法：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E5%86%99%E6%B3%95%EF%BC%9A"><span class="toc-number">8.2.1.2.2.</span> <span class="toc-text">第二种写法：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B%E2%80%94SessionFactory%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.2.</span> <span class="toc-text">Hibernate API简介—SessionFactory接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8C3P0%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">使用C3P0连接池</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B%E2%80%94Session%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.3.</span> <span class="toc-text">Hibernate API简介—Session接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">8.2.3.1.</span> <span class="toc-text">常用方法如下：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B%E2%80%94Transaction%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.4.</span> <span class="toc-text">Hibernate API简介—Transaction接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B%E2%80%94-Query%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.5.</span> <span class="toc-text">Hibernate API简介— Query接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Query%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">8.2.5.1.</span> <span class="toc-text">使用Query对象的步骤：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate-API%E7%AE%80%E4%BB%8B%E2%80%94Criteria%E6%8E%A5%E5%8F%A3"><span class="toc-number">8.2.6.</span> <span class="toc-text">Hibernate API简介—Criteria接口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hibernate-%E6%8C%81%E4%B9%85%E5%8C%96%E9%85%8D%E7%BD%AE%E5%92%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">9.</span> <span class="toc-text">Hibernate 持久化配置和操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hibernate-%E4%B8%AD%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB"><span class="toc-number">9.1.</span> <span class="toc-text">Hibernate 中的持久化类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86OID"><span class="toc-number">9.2.</span> <span class="toc-text">持久化对象的唯一标识OID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%88%86%E8%87%AA%E7%84%B6%E4%B8%BB%E9%94%AE%E4%B8%8E%E4%BB%A3%E7%90%86%E4%B8%BB%E9%94%AE"><span class="toc-number">9.3.</span> <span class="toc-text">区分自然主键与代理主键</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%E5%B1%9E%E6%80%A7%E7%94%A8%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E8%BF%98%E6%98%AF%E5%8C%85%E8%A3%85%E7%B1%BB%E5%9E%8B%EF%BC%9F"><span class="toc-number">9.4.</span> <span class="toc-text">持久化类属性用基本类型还是包装类型？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E8%A7%A3%E5%AF%B9%E8%B1%A1%E2%80%94%E5%85%B3%E7%B3%BB%E6%98%A0%E5%B0%84-hbm-%E6%96%87%E4%BB%B6"><span class="toc-number">9.5.</span> <span class="toc-text">详解对象—关系映射 hbm 文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ID-%E5%92%8C-generator-%E5%B1%9E%E6%80%A7%E8%AF%B4%E6%98%8E"><span class="toc-number">9.6.</span> <span class="toc-text">ID 和 generator 属性说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5"><span class="toc-number">9.7.</span> <span class="toc-text">主键生成策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5increment"><span class="toc-number">9.7.1.</span> <span class="toc-text">主键生成策略increment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5-identity"><span class="toc-number">9.7.2.</span> <span class="toc-text">主键生成策略 identity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5-sequence"><span class="toc-number">9.7.3.</span> <span class="toc-text">主键生成策略 sequence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5-native"><span class="toc-number">9.7.4.</span> <span class="toc-text">主键生成策略 native</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5-uuid"><span class="toc-number">9.7.5.</span> <span class="toc-text">主键生成策略 uuid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5-assigned"><span class="toc-number">9.7.6.</span> <span class="toc-text">主键生成策略 assigned</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%A4%8D%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-number">9.7.7.</span> <span class="toc-text">映射复合主键</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A-1"><span class="toc-number">10.</span> <span class="toc-text">实例：</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/01/10/SpringCloud/08.%E7%86%94%E6%96%AD%E4%B8%8E%E9%99%90%E6%B5%81/" title="SpringCloud | 熔断与限流"><img src="https://img.paulzzh.com/touhou/random" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="SpringCloud | 熔断与限流"/></a><div class="content"><a class="title" href="/2022/01/10/SpringCloud/08.%E7%86%94%E6%96%AD%E4%B8%8E%E9%99%90%E6%B5%81/" title="SpringCloud | 熔断与限流">SpringCloud | 熔断与限流</a><time datetime="2022-01-10T13:17:54.000Z" title="发表于 2022-01-10 21:17:54">2022-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/05/SpringCloud/07.%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" title="SpringCloud | 服务注册和配置中心"><img src="https://api.ixiaowai.cn/api/api.php" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="SpringCloud | 服务注册和配置中心"/></a><div class="content"><a class="title" href="/2022/01/05/SpringCloud/07.%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" title="SpringCloud | 服务注册和配置中心">SpringCloud | 服务注册和配置中心</a><time datetime="2022-01-05T14:19:38.000Z" title="发表于 2022-01-05 22:19:38">2022-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/30/SpringCloud/06.%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE/" title="SpringCloud | 服务配置"><img src="https://api.ixiaowai.cn/api/api.php" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="SpringCloud | 服务配置"/></a><div class="content"><a class="title" href="/2021/12/30/SpringCloud/06.%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE/" title="SpringCloud | 服务配置">SpringCloud | 服务配置</a><time datetime="2021-12-30T13:16:50.000Z" title="发表于 2021-12-30 21:16:50">2021-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/27/SpringCloud/05.%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3/" title="SpringCloud | 服务网关"><img src="https://img.paulzzh.com/touhou/random" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="SpringCloud | 服务网关"/></a><div class="content"><a class="title" href="/2021/12/27/SpringCloud/05.%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3/" title="SpringCloud | 服务网关">SpringCloud | 服务网关</a><time datetime="2021-12-27T12:34:37.000Z" title="发表于 2021-12-27 20:34:37">2021-12-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/23/Mybatis/03.Mybatis%E5%BC%80%E5%8F%91dao/" title="Mybatis | Mybatis开发dao"><img src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/atideas/assets/static/404.jpg'" alt="Mybatis | Mybatis开发dao"/></a><div class="content"><a class="title" href="/2021/12/23/Mybatis/03.Mybatis%E5%BC%80%E5%8F%91dao/" title="Mybatis | Mybatis开发dao">Mybatis | Mybatis开发dao</a><time datetime="2021-12-23T10:55:53.000Z" title="发表于 2021-12-23 18:55:53">2021-12-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Feng Deng</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">愿漂泊的人都有酒喝,孤独的人都会唱歌</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '1UHXekkb2FIztWkcxykWIrb5-9Nh9j0Va',
      appKey: 'paFEd6U94HDMBJ5ejtxfxBwM',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: {"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png"},
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>